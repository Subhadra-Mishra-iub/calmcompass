generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           String    @id @default(cuid())
  name         String
  email        String    @unique
  passwordHash String    @map("password_hash")
  createdAt    DateTime  @default(now()) @map("created_at")
  
  emotions Emotion[]
  checkIns CheckIn[]
  
  @@map("users")
}

model Emotion {
  id        String   @id @default(cuid())
  userId    String   @map("user_id")
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  
  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  actions  Action[]
  checkIns CheckIn[]
  
  @@unique([userId, name])
  @@map("emotions")
}

model Action {
  id          String   @id @default(cuid())
  emotionId   String   @map("emotion_id")
  title       String
  description String?  @db.Text
  url         String?
  createdAt   DateTime @default(now()) @map("created_at")
  
  emotion      Emotion         @relation(fields: [emotionId], references: [id], onDelete: Cascade)
  checkInActions CheckInAction[]
  
  @@map("actions")
}

model CheckIn {
  id        String   @id @default(cuid())
  userId    String   @map("user_id")
  emotionId String   @map("emotion_id")
  notes     String?  @db.Text
  createdAt DateTime @default(now()) @map("created_at")
  
  user          User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  emotion       Emotion         @relation(fields: [emotionId], references: [id], onDelete: Cascade)
  checkInActions CheckInAction[]
  
  @@map("check_ins")
}

model CheckInAction {
  id        String   @id @default(cuid())
  checkInId String   @map("check_in_id")
  actionId  String   @map("action_id")
  completed Boolean  @default(false)
  
  checkIn CheckIn @relation(fields: [checkInId], references: [id], onDelete: Cascade)
  action  Action  @relation(fields: [actionId], references: [id], onDelete: Cascade)
  
  @@unique([checkInId, actionId])
  @@map("check_in_actions")
}